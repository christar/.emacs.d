#+TITLE: christar's emacs config
#+OPTIONS: toc:2 h:2
#+STARTUP: content

* Todo                                                                  :TBC:
** remove all DONE states
** check all not used codes
tagged with TBC

* Startup
** DONE define platform                                      :mac:linux:win:
Define the variable for each platform

#+begin_src emacs-lisp :tangle yes
(defun mac-p ()
    (eq system-type 'darwin))
(defun linux-p ()
    (eq system-type 'gnu/linux))
(defun win-p ()
    (eq system-type 'windows-nt))
#+end_src

** DONE startup config                                       :win:mac:linux:
Hide Scrollbar on Windows
Hide Toolbar on Windows

Remove Welcome Screen
Remove Beep on Windows
Hide Menu Bar
Set Encoding from Windows style(CRLF) to Unix style(LF)

#+begin_src emacs-lisp :tangle yes
(when (win-p)
    (setq inhibit-startup-screen t)
    (tool-bar-mode -1)
    (scroll-bar-mode -1))
(setq visible-bell 1)
(menu-bar-mode -1)
(prefer-coding-system 'utf-8-unix)
(modify-coding-system-alist 'file "\\.bat\\'" 'utf-8-dos)
#+end_src

** WIP start emacs server                                    :mac:linux:win:
For Macos use daemon
For Linux use tmux
For Windows use server
#+begin_src emacs-lisp :tangle yes
(require 'server)
(if (eq system-type 'windows-nt)
    (or (server-running-p)
        (server-start)))
#+end_src

** DONE load custom settings                                          :work:
e.g. Work Proxy Server

#+begin_src emacs-lisp :tangle yes
(setq custom-file "~/.emacs.d/custom-settings.el")
(load custom-file t)
#+end_src

** DONE ELPA repo                                   :work:mac:linux:win:pac:
GnuTLS manually installed by installing deps package from Emacs FTP server

#+begin_src emacs-lisp :tangle yes
(require 'package)
(setq package-enable-at-startup nil)
(add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/"))
(package-initialize)
#+end_src

** DONE use-package                                                :pac:TBC:
There is a debate between using package.el and use-package.el
Should look into that later

CHECKME -> bug installing diminish package

#+begin_src emacs-lisp :tangle yes
(unless (package-installed-p 'use-package)
    (package-refresh-contents)
    (package-install 'use-package))
(eval-when-compile
    (defvar use-package-verbose t)
    (defvar use-package-always-ensure t)
    (require 'use-package))
(require 'diminish)
(require 'bind-key)
(package-initialize)
(use-package auto-compile
    :config
    (auto-compile-on-load-mode)
    (auto-compile-on-save-mode)
    (setq auto-compile-display-buffer               nil)
    (setq auto-compile-mode-line-counter            t)
    (setq auto-compile-source-recreate-deletes-dest t)
    (setq auto-compile-toggle-deletes-nonlib-dest   t)
    (setq auto-compile-update-autoloads             t))
(setq load-prefer-newer t)
#+end_src

** DONE compress byte compile warnings                                 :pac:
#+begin_src emacs-lisp :tangle yes
(setq byte-compile-warnings nil
    gnutls-min-prime-bits 4096)
#+end_src

** DONE keep auto backup files                                        :edit:
File of the same name but with a tilda ~ at the end

#+begin_src emacs-lisp :tangle yes
(setq backup-directory-alist '(("." . "~/.emacs.d/backup/"))
    backup-by-copying t    ; Don't delink hardlinks
    version-control t      ; Use version numbers on backups
    delete-old-versions t  ; Automatically delete excess backups
    kept-new-versions 20   ; how many of the newest versions to keep
    kept-old-versions 5    ; and how many of the old
    )
#+end_src

** DONE keep auto save files                                          :edit:
File of the same name but with # at both sides
#+begin_src emacs-lisp :tangle yes
(setq auto-save-default t)
(setq auto-save-file-name-transforms '((".*" "~/.emacs.d/backup/" t)))
#+end_src

* UI
** DONE theme                                                    :theme:org:
Remove theme-specific org-mode headline font settings
#+begin_src emacs-lisp :tangle yes
(use-package spacemacs-theme
    :defer t
    :if window-system
    :init
    (load-theme 'spacemacs-light t)
    (set-face-attribute 'default nil :font "Consolas-11")
    (custom-theme-set-faces
       'spacemacs-light
       '(org-document-title ((t (:weight bold :height 1.2))))
       '(org-level-1 ((t (:weight semi-bold :height 1.2))))
       '(org-level-2 ((t (:weight semi-bold :height 1.0))))
       '(org-level-3 ((t (:weight normal :height 1.0))))
       '(org-level-4 ((t (:weight normal :height 1.0))))
       '(org-level-5 ((t (:weight normal :height 1.0))))))
#+end_src

** DONE enable Y/N answer
#+begin_src emacs-lisp :tangle yes
(fset 'yes-or-no-p 'y-or-n-p)
#+end_src

** DONE ivy                                                       :edit:ivy:
fuzzy search in ivy minibuffer

#+begin_src emacs-lisp :tangle yes
(use-package ivy
    :defer 1
    :config
    (progn
        (ivy-mode 1)
        (setq ivy-use-virtual-buffers t)
        (setq ivy-re-builders-alist
            '((t . ivy--regex-fuzzy)))
        (setq enable-recursive-minibuffers t)))
#+end_src

** DONE swiper                                                    :edit:ivy:
bind search hotkey to swiper

#+begin_src emacs-lisp :tangle yes
(use-package swiper
    :defer 1
    :bind ("C-s" . 'swiper))
#+end_src

** DONE counsel                                                        :ivy:
#+begin_src emacs-lisp :tangle yes
(use-package counsel
    :defer 1
    :bind
    (("C-x C-f" . counsel-find-file)
     ("C-h f" . counsel-describe-function)
     ("C-h v" . counsel-describe-variable)
     ("M-x" . counsel-M-x)))
#+end_src

** TODO customize modeline                                           :theme:
understand what all areas stand for
#+begin_src emacs-lisp :tangle yes
(column-number-mode t)
#+end_src

** DONE split window with different buffers                           :edit:
#+begin_src emacs-lisp :tangle yes
(defun hsplit-last-buffer()
    (interactive)
    (split-window-below)
    (other-window 1 nil)
    (switch-to-next-buffer))
(global-set-key (kbd "C-x 2") 'hsplit-last-buffer)
(defun vsplit-last-buffer()
    (interactive)
    (split-window-right)
    (other-window 1 nil)
    (switch-to-next-buffer))
(global-set-key (kbd "C-x 3") 'vsplit-last-buffer)
#+end_src

* Editor
** DONE curson position highlighting                                  :edit:
#+begin_src emacs-lisp :tangle yes
(use-package beacon
    :defer t
    :config (beacon-mode 1))
#+end_src

** DONE parentheses                                                   :edit:
There is smartparens mode worth noting.

#+begin_src emacs-lisp :tangle yes
(show-paren-mode 1)
(setq show-paren-delay 0)
(electric-pair-mode 1)
#+end_src

** DONE page break line                                                :TBC:
#+begin_src emacs-lisp :tangle no
(use-package page-break-lines
    :diminish page-break-lines-mode
    :config (global-page-break-lines-mode 1))
#+end_src

** DONE trailing space                                                :edit:
auto remove on save

#+begin_src emacs-lisp :tangle yes
(add-hook 'before-save-hook 'delete-trailing-whitespace)
#+end_src

** WIP toggle (multiple) line comment                                 :edit:
C++ comment style
#+begin_src emacs-lisp :tangle yes
(defun comment-or-uncomment-region-or-line ()
  (interactive)
  (let ((start (line-beginning-position))
        (end (line-end-position)))
    (when (or (not transient-mark-mode) (region-active-p))
      (setq start (save-excursion
                    (goto-char (region-beginning))
                    (beginning-of-line)
                    (point))
            end (save-excursion
                  (goto-char (region-end))
                  (end-of-line)
                  (point))))
    (comment-or-uncomment-region start end)))

(global-set-key (kbd "C-c C-7") 'comment-or-uncomment-region-or-line)
#+end_src

** DONE undo-tree                                                     :edit:
#+begin_src emacs-lisp :tangle yes
(use-package undo-tree
    :diminish undo-tree-mode
    :defer t
    :bind ("C-x u" . undo-tree-visualize)
    :config (global-undo-tree-mode))
#+end_src

** TODO flyspell                                                      :edit:
** prelude-like C-a behavior                                          :edit:
jump to the beginning word of line
* File Management
** DONE dired                                                    :TBC:dired:
#+begin_src emacs-lisp :tangle yes
(setq dired-recursive-deletes 'always)
(setq dired-recursive-copies 'always)
#+end_src

** TODO !!! jump to any file in a deep folder structure         :dired:perf:
maybe bookmark is used?

** DONE remember last cursor position in dired & file                :dired:
someone had recentf-mode is activated, so this function is enabled.
just need to gitignore the recentf file in the .emacs.d folder

* Programming
** DONE special file type mode                                 :edit:c:make:
#+begin_src emacs-lisp :tangle yes
(add-to-list 'auto-mode-alist '("\\.can\\'" . c-mode))
(add-to-list 'auto-mode-alist '("\\.cin\\'" . c-mode))
(add-to-list 'auto-mode-alist '("\\.mak\\'" . makefile-mode))
#+end_src

** TODO flycheck                                                    :edit:c:

** TODO yasnippet                                                   :edit:c:

** DONE indentation                                             :edit:c:TBC:
disable tab to indent globally

#+begin_src emacs-lisp :tangle yes
(setq-default indent-tabs-mode nil)
(setq-default tab-width 4) ; default is 8
(defvaralias 'c-basic-offset 'tab-width)
(setq c-default-style "linux")
(c-set-offset 'case-label '+)
#+end_src

** WIP company + clang                                          :c:edit:TBC:
if/for statement auto completion

possible sublime-like fuzzy completion
need to input no candidate words
input ignore casing

install clang for windows

#+begin_src emacs-lisp :tangle yes
(use-package company
    :defer 3
    :init (global-company-mode)
    :config (setq company-idle-delay 0))
#+end_src

** multiple line editing                                              :edit:
** WIP source code indexing/navigation                                   :c:
#+begin_src emacs-lisp :tangle yes
(use-package counsel-gtags
    :hook cc-mode
    :bind
    (("M-t" . counsel-gtags-find-definition)
     ("M-r" . counsel-gtags-find-reference)
     ("M-s" . counsel-gtags-find-symbol)
     ("M-," . counsel-gtags-go-backward)))
#+end_src

*** function arguments hinting                                     :edit:c:
*** GNU global + helm-gtags                                        :c:helm:
prefix + shortkey
*** add project path (multiple folders)

* General

** DONE global auto revert mode                                       :edit:
#+begin_src emacs-lisp :tangle yes
(global-auto-revert-mode t)
#+end_src

** DONE which-key
display available shortkeys in minibuffer popup

#+begin_src emacs-lisp :tangle yes
(use-package which-key
    :defer 2
    :diminish which-key-mode
    :config (which-key-mode))
#+end_src

** helm                                                               :helm:
helm-ag for searching
helm window in split windows
M-x should be only under the splitted windows, not sure if it is ivy or helm
#+begin_src emacs-lisp :tangle yes
(use-package helm)
#+end_src

** M-x echo area(minibuffer)

** run build.bat from minibuffer                                    :c:make:
build.bat is not available yet
* Org mode
** DONE org agenda path                                                :org:
this one is system-specific and should be defined in the custom settings
#+begin_src emacs-lisp :tangle no
(setq org-agenda-files '("~/org"))
#+end_src

** DONE use org-indent-mode                                            :org:
#+begin_src emacs-lisp :tangle yes
(setq org-startup-indented t)
#+end_src

** WIP workflow                                                        :org:
*** DONE add workflow states
#+begin_src emacs-lisp :tangle yes
(setq org-todo-keywords
    '((sequence "TODO" "WIP" "|" "DONE")))
(setq org-todo-keyword-faces
      '(("TODO" . "red")))
(setq org-todo-keyword-faces
      '(("WIP" . "yellow")))
;(setq org-todo-keyword-faces
;      '(("HOLD" . "red")))
#+end_src

*** DONE normal C-t action is to close TODO tasks with timestamp
#+begin_src emacs-lisp :tangle yes
(setq org-log-done 'time)
#+end_src

*** TODO setting a shortkey for set workflow state
#+begin_src emacs-lisp :tangle yes
#+end_src

** DONE no newline before new heading                                  :org:
without the added newline on top
#+begin_src emacs-lisp :tangle yes
(setf org-blank-before-new-entry '((heading . nil) (plain-list-item . nil)) )
#+end_src

** DONE open files with external app                                   :org:
#+begin_src emacs-lisp :tangle yes
(add-hook 'org-mode-hook
    '(lambda ()
        (setq org-file-apps
            (append '(
                      ("\\.png\\'" . default)
                      ("\\.ppt\\'" . default)
                      ("\\.pptx\\'" . default)
                      ) org-file-apps ))))
#+end_src

** DONE hotkey for org-agenda
#+begin_src emacs-lisp :tangle yes
(add-hook 'org-mode-hook
    '(lambda ()
        (local-set-key "\C-ca" 'org-agenda)))
#+end_src

* Notes
** emacs lisp
this is a thing for elisp learning: ";; -*- lexical-binding: t -*-"
